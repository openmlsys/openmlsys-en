<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>2.1. Computational Graph Functions &#8212; Machine Learning Systems: Design and Implementation 1.0.0 documentation</title>

    <link rel="stylesheet" href="../_static/material-design-lite-1.3.0/material.blue-deep_orange.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx_materialdesign_theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fontawesome/all.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/d2l.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/d2l.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.2. Computational Graph Basics" href="components_of_computational_graph.html" />
    <link rel="prev" title="2. Computational Graph" href="index.html" /> 
  </head>
<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer"><header class="mdl-layout__header mdl-layout__header--waterfall ">
    <div class="mdl-layout__header-row">
        
        <nav class="mdl-navigation breadcrumb">
            <a class="mdl-navigation__link" href="index.html"><span class="section-number">2. </span>Computational Graph</a><i class="material-icons">navigate_next</i>
            <a class="mdl-navigation__link is-active"><span class="section-number">2.1. </span>Computational Graph Functions</a>
        </nav>
        <div class="mdl-layout-spacer"></div>
        <nav class="mdl-navigation">
        
<form class="form-inline pull-sm-right" action="../search.html" method="get">
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
        <label id="quick-search-icon" class="mdl-button mdl-js-button mdl-button--icon"  for="waterfall-exp">
          <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="q"  id="waterfall-exp" placeholder="Search" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </div>
      </div>
      <div class="mdl-tooltip" data-mdl-for="quick-search-icon">
      Quick search
      </div>
</form>
        
<a id="button-show-source"
    class="mdl-button mdl-js-button mdl-button--icon"
    href="../_sources/chapter_computational_graph/background_and_functionality.rst.txt" rel="nofollow">
  <i class="material-icons">code</i>
</a>
<div class="mdl-tooltip" data-mdl-for="button-show-source">
Show Source
</div>
        </nav>
    </div>
    <div class="mdl-layout__header-row header-links">
      <div class="mdl-layout-spacer"></div>
      <nav class="mdl-navigation">
          
              <a  class="mdl-navigation__link" href="https://github.com/openmlsys/openmlsys-en">
                  <i class="fab fa-github"></i>
                  GitHub
              </a>
          
              <a  class="mdl-navigation__link" href="https://openmlsys.github.io/">
                  <i class="fas fa-external-link-alt"></i>
                  中文版
              </a>
      </nav>
    </div>
</header><header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../index.html">
              <img class="logo" src="../_static/logo-with-text.png" alt="Machine Learning Systems: Design and Implementation"/>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chapter_preface/index.html">1. Preface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. Computational Graph</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.1. Computational Graph Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="components_of_computational_graph.html">2.2. Computational Graph Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="generation_of_computational_graph.html">2.3. Generating a Computational Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="schedule_of_computational_graph.html">2.4. Scheduling and Executing Computational Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">2.5. Chapter Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html#further-reading">2.6. Further Reading</a></li>
</ul>
</li>
</ul>

            </nav>
        
        </div>
    
</header>
        <main class="mdl-layout__content" tabIndex="0">

	<script type="text/javascript" src="../_static/sphinx_materialdesign_theme.js "></script>
    <header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../index.html">
              <img class="logo" src="../_static/logo-with-text.png" alt="Machine Learning Systems: Design and Implementation"/>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chapter_preface/index.html">1. Preface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. Computational Graph</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.1. Computational Graph Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="components_of_computational_graph.html">2.2. Computational Graph Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="generation_of_computational_graph.html">2.3. Generating a Computational Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="schedule_of_computational_graph.html">2.4. Scheduling and Executing Computational Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">2.5. Chapter Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html#further-reading">2.6. Further Reading</a></li>
</ul>
</li>
</ul>

            </nav>
        
        </div>
    
</header>

    <div class="document">
        <div class="page-content" role="main">
        
  <div class="section" id="computational-graph-functions">
<h1><span class="section-number">2.1. </span>Computational Graph Functions<a class="headerlink" href="#computational-graph-functions" title="Permalink to this heading">¶</a></h1>
<div class="figure align-default" id="id1">
<span id="dag"></span><a class="reference internal image-reference" href="../_images/graph.png"><img alt="../_images/graph.png" src="../_images/graph.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.1 </span><span class="caption-text">Computational graph–based architecture</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>Early machine learning frameworks are mainly designed for fully
connected networks and convolutional neural networks (CNNs). Such neural
networks have serial layers, whose topology structures can be
represented in simple configuration files (e.g., Caffe model definition
in Protocol Buffers format).</p>
<p>Early machine learning frameworks are mainly designed for fully
connected networks and convolutional neural networks (CNNs). Such neural
networks have serial layers, whose topology structures can be
represented in simple configuration files (e.g., Caffe model definition
in Protocol Buffers format).</p>
<p>Conversely, modern machine learning models have ever more complex
structures. Prominent examples include mixture-of-experts (MoE),
generative adversarial network (GAN), and attention models. To improve
the training efficiency with complex model structures (e.g., loops with
branching), machine learning frameworks are expected to quickly analyze
operator dependencies, gradient computation, and training parameters, to
facilitate model optimization, formulate scheduling strategies, and
automate gradient computation. As such, machine learning system
designers call for a common data structure to understand, represent, and
execute machine learning models. To this end, machine learning
frameworks introduce the computational graph technology while still
decoupling the frontend and backend languages in design, as shown in
<a class="reference internal" href="#dag"><span class="std std-numref">Fig. 2.1.1</span></a>. From a top-level view, computational graph technology
provides the following key functions:</p>
<ul class="simple">
<li><p><strong>Unified representation of the computation process.</strong> Developers
tend to write machine learning programs in high-level programming
languages (e.g., Python, Julia, and C++). However, because most
devices such as hardware accelerators provide only C/C++ APIs,
implementations of machine learning systems are largely restricted to
C/C++. Computational graph technology makes it possible to run
programs written in different high-level languages on common
low-level C/C++ system modules. As a unified representation, a
computational graph describes a model’s input data, computational
logic (usually referred to as operators), and execution sequence of
operators.</p></li>
<li><p><strong>Automatic gradient computation.</strong> The training program receives
data samples (or the training dataset), performs forward computation
through the network, and then calculates the loss value. Based on the
loss value, the machine learning system computes the gradient for
each model parameter and then updates the model parameters. The
gradient computation method should apply universally and run
automatically, regardless of the model topology and loss computation
method. Based on the computational graph, the machine learning system
can quickly analyze the gradient transfer relations between
parameters, thereby achieving automatic gradient computation.</p></li>
<li><p><strong>Lifetime analysis of model variables.</strong> During model training, many
intermediate variables are generated, for example, the activation
values in the forward pass and the gradients in the backward pass.
Some of the intermediate variables generated in the forward pass are
used in conjunction with the gradients for updating model parameters.
With a computational graph, the machine learning system can
accurately analyze the lifetime of each intermediate variable (i.e.,
from the time the variable is generated to the time it is destroyed),
helping the framework optimize memory management.</p></li>
<li><p><strong>Execution optimization.</strong> User programs can have different network
structures. With computational graph technology, the machine learning
framework can analyze the model topology and operator dependencies,
and it automatically searches for operator parallel computing
strategies to improve the model execution efficiency.</p></li>
</ul>
</div>


        </div>
        <div class="side-doc-outline">
            <div class="side-doc-outline--content"> 
            </div>
        </div>

      <div class="clearer"></div>
    </div><div class="pagenation">
     <a id="button-prev" href="index.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="P">
         <i class="pagenation-arrow-L fas fa-arrow-left fa-lg"></i>
         <div class="pagenation-text">
            <span class="pagenation-direction">Previous</span>
            <div>2. Computational Graph</div>
         </div>
     </a>
     <a id="button-next" href="components_of_computational_graph.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="N">
         <i class="pagenation-arrow-R fas fa-arrow-right fa-lg"></i>
        <div class="pagenation-text">
            <span class="pagenation-direction">Next</span>
            <div>2.2. Computational Graph Basics</div>
        </div>
     </a>
  </div>
        
        </main>
    </div>
  </body>
</html>